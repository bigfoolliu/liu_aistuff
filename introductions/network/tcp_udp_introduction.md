# tcp和udp

<!-- vim-markdown-toc Marked -->

* [1.tcp](#1.tcp)
    - [1,1概述](#1,1概述)
    - [1.2三次握手，四次挥手](#1.2三次握手，四次挥手)
    - [1.3tcp粘包](#1.3tcp粘包)
* [2.udp](#2.udp)
    - [2.1概述](#2.1概述)

<!-- vim-markdown-toc -->

## 1.tcp

### 1,1概述

- 面向连接，可靠（`但也不是100%，实际是数据的可靠传递和故障的可靠通知`）
- 使用`校验和`，`确认`和`重传`机制来保证可靠传输
- 对数据分节进行排序，并使用累积确认保证数据的顺序不变和非重复
- tcp面向连接，适合文件传输，远程登录等

### 1.2三次握手，四次挥手

`三次握手`指客户端和服务端首次建立连接的时候需要发送三个包：

1. 客户端发送`SYN`标志位为1的包，指明需要连接的服务器的端口以及初始序号X，客户端处于`SYN_SEND`状态
2. 服务端发送`ACK`确认包应答，SYN和ACK标志位均为1，服务端处于`SYN_RCVD`状态
3. 客户端发送`ACK`确认应打包，SYN标志位为0，ACK标志位为1，客户端进入`ESTABLISHED`状态

`tcp标志位`,有6种标示：[tcp标志位详解](https://blog.csdn.net/chenvast/article/details/77978367)

`四次挥手`指tcp连接的拆除，需要发送四个包：

1. 客户端发送`FIN`标志位为1的包，表示自己无数据发送，但可以接收数据
2. 服务端发送`ACK`包，表示自己收到关闭连接的请求，但未准备好关闭
3. 服务端发送`FIN`标志位为1的包，表示自己结束连接
4. 客户端发送`ACK`确认收到服务端的关闭请求




### 1.3tcp粘包

- [什么是TCP粘包以及如何解决](https://blog.csdn.net/weixin_41047704/article/details/85340311)

原因：

1. 当连续发送数据时候，TCP的nagle算法将较小的内容拼接为大的内容，一次性发送，造成粘包;
2. 发送的数据较大时，服务端的buff_size较小，不能一次性接收所有的内容，下次请求到达时候接收的是上次没有完全接收完的东西，造成粘包。

## 2.udp

### 2.1概述

- 非可靠，不提供确认，序列号，超时重传等机制
- 数据包的长度有限
- 无连接
- 支持多播和广播
- udp提供的无状态的连接，适合语音，直播，视频等
