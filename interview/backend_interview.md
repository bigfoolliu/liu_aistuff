# 后端面试

<!-- TOC -->

- [后端面试](#%e5%90%8e%e7%ab%af%e9%9d%a2%e8%af%95)
  - [1.HTTP](#1http)
    - [1.1介绍](#11%e4%bb%8b%e7%bb%8d)
    - [1.2GET](#12get)
    - [1.3Keep-Alive模式](#13keep-alive%e6%a8%a1%e5%bc%8f)
    - [1.4Token](#14token)
  - [2.HTTPS](#2https)
    - [2.1介绍](#21%e4%bb%8b%e7%bb%8d)
    - [2.2SSL证书](#22ssl%e8%af%81%e4%b9%a6)
  - [3.TCP协议](#3tcp%e5%8d%8f%e8%ae%ae)
    - [3.1介绍](#31%e4%bb%8b%e7%bb%8d)
    - [3.2三次握手，四次挥手](#32%e4%b8%89%e6%ac%a1%e6%8f%a1%e6%89%8b%e5%9b%9b%e6%ac%a1%e6%8c%a5%e6%89%8b)
  - [4.UDP协议](#4udp%e5%8d%8f%e8%ae%ae)
    - [4.1介绍](#41%e4%bb%8b%e7%bb%8d)
  - [5.并发技术](#5%e5%b9%b6%e5%8f%91%e6%8a%80%e6%9c%af)
    - [5.1进程](#51%e8%bf%9b%e7%a8%8b)
    - [5.2线程](#52%e7%ba%bf%e7%a8%8b)
    - [5.3协程](#53%e5%8d%8f%e7%a8%8b)
    - [5.4I/O多路复用](#54io%e5%a4%9a%e8%b7%af%e5%a4%8d%e7%94%a8)
  - [6.内存管理](#6%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86)
    - [6.1栈](#61%e6%a0%88)
    - [6.2堆](#62%e5%a0%86)
    - [6.3内存抖动](#63%e5%86%85%e5%ad%98%e6%8a%96%e5%8a%a8)
  - [7.磁盘](#7%e7%a3%81%e7%9b%98)
    - [7.1磁盘调度](#71%e7%a3%81%e7%9b%98%e8%b0%83%e5%ba%a6)

<!-- /TOC -->

## 1.HTTP

### 1.1介绍

- 基于TCP/IP，应用层协议，默认端口为80
- `无状态`(对于交互式场景没有记忆)，`无连接`(限制每次连接只处理一个请求，且请求完成断开连接)

### 1.2GET

条件GET：

如果客户端重新请求的这段时间内，服务端的页面没有改变，则应该使用浏览器缓存的数据。根据客户端的请求头：

```text
If-Modified-Since:Thu, 4 Feb 2010 20:39:13 GMT
```

服务端根据该字段的时间，如果当前的响应内容没有改变，则返回`304 Not Modified`,客户端使用缓存内容。

### 1.3Keep-Alive模式

非该模式下的时候，每一次请求都要建立一次连接；该模式(持久连接)下，可以使连接持续有效，避免下次请求的时候需要重新建立连接。

### 1.4Token

含义：为`令牌`，服务端生成的一串字符串，作为客户端请求的标识，比如登录一次后生成，下次请求只需携带该Token即可。

解决问题：

1. 由应用管理，可以避开`同源策略`(同源指两个页面的协议，端口和域名都相同，同源策略指不同源的客户端脚本在没有明确授权的情况下不可以读写对方的资源)
2. 可以避免CSRF攻击
3. 可以是无状态的，可以在多个服务器之间共享

## 2.HTTPS

### 2.1介绍

[HTTPS基础介绍](https://blog.51cto.com/11883699/2160032)

基于`TLS`或者`SSL`提供加密处理数据，在加密信道进行HTTP内容传输的协议。

- 通信的过程：采用对称加密进行通信
- 协商通信的过程：采用非对称加密解决对协商过程的加密（应为相对而言，非对称加密的耗时较长）
  - 非对称加密使用的公钥获取依赖`SSL证书(需要购买)`和`CA机构`

### 2.2SSL证书

包括颁发机构，有效期，公钥，证书持有者，签名。

1. 浏览器校验证书中的颁发者，有效期等
2. 浏览器查找本地内置的受信任的证书颁发机构，与之对比，校验是否合法
3. 不合法说明证书不可信；合法则使用相同的hash算法进行解密签名
4. 读取证书中的公钥，进行后续加密

**证书获取**：

- 向一些云服务商申请，获取得到该CA机构的文件(`.CSR`)
- 其中KEY文件，为对应的server端的私钥（`丢失无法找回`）

**配置https**：

[阿里云SSL配置Apache,nginx等](https://help.aliyun.com/video_detail/54216.html?spm=a2c4g.11186623.4.1.WbwjQN)

```nginx
"nginx新增配置项"
listen 443 ssl;
ssl_certificate     /iyunwen/server/ssl/20180731.cer;
ssl_certificate_key /iyunwen/server/ssl/20180731.key;
ssl_prefer_server_ciphers on;
ssl_session_timeout 10m;
ssl_session_cache shared:SSL:10m;
ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
ssl_ciphers "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4";
```

## 3.TCP协议

### 3.1介绍

- 面向连接，可靠（`但也不是100%，实际是数据的可靠传递或故障的可靠通知`）
- 使用`校验和`，`确认`和`重传`机制来保证可靠传输
- 对数据分节进行排序，并使用累积确认保证数据的顺序不变和非重复

### 3.2三次握手，四次挥手

`三次握手`指客户端和服务端首次建立连接的时候需要发送三个包：

1. 客户端发送SYN标志位为1的包，指明需要连接的服务器的端口以及初始序号X，客户端处于`SYN_SEND`状态
2. 服务端发送ACK确认包应答，SYN和ACK标志位均为1，服务端处于`SYN_RCVD`状态
3. 客户端发送ACK确认应打包，SYN标志位为0，ACK标志位为1，客户端进入`ESTABLISHED`状态

`tcp标志位`,有6种标示：[tcp标志位详解](https://blog.csdn.net/chenvast/article/details/77978367)

`四次挥手`指tcp连接的拆除，需要发送四个包：

1. 客户端发送FIN标志位为1的包，表示自己无数据发送，但可以接收数据
2. 服务端发送ACK包，表示自己收到关闭连接的请求，但未准备好关闭
3. 服务端发送FIN标志位为1的包，表示自己结束连接
4. 客户端发送ACK确认收到服务端的关闭请求

## 4.UDP协议

### 4.1介绍

- 非可靠，不提供确认，序列号，超时重传等机制
- 数据包的长度有限
- 无连接
- 支持多播和广播

## 5.并发技术

### 5.1进程

- 进程是一个实体，每一个进程有自己的地址空间（`文本区域(text region)`，`数据区域(data region)`，`堆栈(stack region)`）
  - 文本区域：存储处理器执行的代码
  - 数据区域：存储变量和动态分配的内存
  - 堆栈区域：存储活动过程调用的指令和本地变量
- 进程是一个`执行中的程序`

*进程切换*（或上下文切换）就是`从正在运行的进程中收回处理器，用新的进程塞进处理器，同时切换虚拟内存空间`;
*线程切换*与进程切换的区别就是不会切换虚拟内存空间。

**进程间通信**：

1. 消息传递（`管道`，`FIFO`，`消息队列(MQ)`）
2. 同步(`互斥量`，`条件变量`，`读写锁`，`文件和写记录锁`，`信号量`)
3. 共享内存(`匿名的`，`具名的`)
4. 远程过程调用(`RPC`)

### 5.2线程

- 轻量级线程，程序执行流的最小单位
- 可以并发执行
- 共享进程资源，所有的线程享有所属进程的共同地址空间

### 5.3协程

- 微线程，或者用户级线程
- 与线程的区别就是`线程是抢占式调用，协程是调度式调用`
- 没有线程的使用多CPU的能力

### 5.4I/O多路复用

最简单的解释就是一个进程同时为多个客户端服务。

[并发编程，I/O多路复用](https://www.cnblogs.com/cainingning/p/9556642.html)

常用I/O复用模型：

- `select`，各个客户端的文件描述符(套接字，socket)维护在一个集合中，select函数监视这些这些文件描述符中哪些可读，如果可读则会让工作进程去读取，最多维持1024个连接
- `poll`，区别于select就是存放集合的数据结构不同，可以连接任意个连接
- `epoll`，select和poll都是通过轮询的方式来查找是否有可读和可写，epoll是基于内核的反射机制，当有活跃的socket的时候，会提前调用设置好的回调函数

## 6.内存管理

### 6.1栈

- 连续的一块内存区域
- 用于存放本地变量，内部临时变量以及与上下文有关的内容
- 机器系统提供，有底层的支持，效率较高

### 6.2堆

- 存放不在栈里的数据，coder控制，容易产生`内存泄漏(Memory Leak)，内存的使用超过分配的最大值`[面试内存泄露问题](https://blog.csdn.net/zy_jibai/article/details/80957169)

### 6.3内存抖动

内存频繁的分配和回收导致卡顿，甚至会发生内存泄漏。

## 7.磁盘

### 7.1磁盘调度

磁盘访问延迟 = 队列时间 + 控制器时间 + `寻道时间(主要耗时)` + 旋转时间 + 传输时间
